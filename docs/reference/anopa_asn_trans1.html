<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>anopaPlot: Easy plotting of proportions. — anopa_asn_trans1 • ANOPA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="anopaPlot: Easy plotting of proportions. — anopa_asn_trans1"><meta name="description" content="The function 'anopaPlot()' performs a plot of proportions for designs
with up to 4 factors according to the
'ANOPA' framework. See lc23;textualANOPA for more. The plot is
realized using the 'superb' library; see cgh21;textualANOPA.
It uses the arc-sine transformation 'A()'."><meta property="og:description" content="The function 'anopaPlot()' performs a plot of proportions for designs
with up to 4 factors according to the
'ANOPA' framework. See lc23;textualANOPA for more. The plot is
realized using the 'superb' library; see cgh21;textualANOPA.
It uses the arc-sine transformation 'A()'."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ANOPA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/A-WhatIsANOPA.html">What is an Analysis of Proportions using the Anscombe Transform?</a></li>
    <li><a class="dropdown-item" href="../articles/B-DataFormatsForProportions.html">Data formats for proportions</a></li>
    <li><a class="dropdown-item" href="../articles/C-ConfidenceIntervals.html">Confidence intervals with proportions</a></li>
    <li><a class="dropdown-item" href="../articles/D-ArringtonExample.html">Analyzing proportions with the Arrington et al. 2002 example</a></li>
    <li><a class="dropdown-item" href="../articles/E-ArcsineIsAsinine.html">Is the ArcSine transformation so asinine in the end?</a></li>
    <li><a class="dropdown-item" href="../articles/F-TestingTypeIError.html">Testing type-I error rates</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dcousin3/ANOPA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>anopaPlot: Easy plotting of proportions.</h1>
      <small class="dont-index">Source: <a href="https://github.com/dcousin3/ANOPA/blob/HEAD/R/ANOPA-plot.R" class="external-link"><code>R/ANOPA-plot.R</code></a></small>
      <div class="d-none name"><code>anopa_asn_trans1.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function 'anopaPlot()' performs a plot of proportions for designs
with up to 4 factors according to the
'ANOPA' framework. See lc23;textualANOPA for more. The plot is
realized using the 'superb' library; see cgh21;textualANOPA.
It uses the arc-sine transformation 'A()'.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anopaPlot</span><span class="op">(</span><span class="va">w</span>, formula <span class="op">=</span> <span class="cn">NULL</span>, confidenceLevel <span class="op">=</span> <span class="fl">.95</span>, allowImputing <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     showPlotOnly <span class="op">=</span> <span class="cn">TRUE</span>, plotLayout <span class="op">=</span> <span class="st">"line"</span>, </span>
<span>     errorbarParams  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> width <span class="op">=</span><span class="fl">0.85</span>, linewidth<span class="op">=</span><span class="fl">0.75</span> <span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>An ANOPA object obtained with <code><a href="anopa.html">anopa()</a></code>;</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>(optional) Use formula to plot just specific terms of the omnibus test.
For example, if your analysis stored in <code>w</code> has factors A, B and C, then
<code>anopaPlot(w, ~ A * B)</code> will only plot the factors A and B.</p></dd>


<dt id="arg-confidencelevel">confidenceLevel<a class="anchor" aria-label="anchor" href="#arg-confidencelevel"></a></dt>
<dd><p>Provide the confidence level for the confidence intervals
(default is 0.95, i.e., 95%).</p></dd>


<dt id="arg-allowimputing">allowImputing<a class="anchor" aria-label="anchor" href="#arg-allowimputing"></a></dt>
<dd><p>(default FALSE) if there are cells with no observations, can they be
imputed? If imputed, the option "ANOPA.zeros" will be used to determine
how many additional observations to add, and with how many successes.
If for example, the option is (by default) <code>c(0.05, 1)</code>, then
20 cases will be added, only one being a success (respecting the .05 target).
<em>Keep in mind that imputations has never been studies with regards to proportions
so be mindful that the default optin has never been tested nor validated.</em></p></dd>


<dt id="arg-showplotonly">showPlotOnly<a class="anchor" aria-label="anchor" href="#arg-showplotonly"></a></dt>
<dd><p>(optional, default True) shows only the plot or else
shows the numbers needed to make the plot yourself.</p></dd>


<dt id="arg-plotlayout">plotLayout<a class="anchor" aria-label="anchor" href="#arg-plotlayout"></a></dt>
<dd><p>(optional; default "line") How to plot the proportions;
see superb for other layouts (e.g., "line").</p></dd>


<dt id="arg-errorbarparams">errorbarParams<a class="anchor" aria-label="anchor" href="#arg-errorbarparams"></a></dt>
<dd><p>(optional; default list( width =0.5, linewidth=0.75 ) ) is
a list of attributes used to plot the error bars. See superb for more.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other directives sent to superb(), typically 'plotLayout',
'errorbarParams', etc.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a ggplot2 object of the given proportions.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The plot shows the proportions on the vertical axis as a
function of the factors (the first on the horizontal axis, the second
if any in a legend; and if a third or even a fourth factors are present,
as distinct rows and columns). It also shows 95% confidence intervals of
the proportions, adjusted for between-cells comparisons.
The confidence intervals are based on a z distribution, which is adequate
for large samples c90,ll90ANOPA. This "stand-alone" confidence
interval is then adjusted for between-cell comparisons using the <em>superb</em>
framework cgh21ANOPA.</p>
<p>See the vignette <a href="../articles/B-DataFormatsForProportions.html"><code>DataFormatsForProportions</code></a>
for more on data formats and how to write their formula.
See the vignette <a href="../articles/C-ConfidenceIntervals.html"><code>ConfidenceIntervals</code></a> for
details on the adjustment and its purpose.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># The Arrington Et Al., 2002, data on fishes' stomach</span></span></span>
<span class="r-in"><span><span class="va">ArringtonEtAl2002</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Location    Trophism      Diel    s    n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                 Africa Detritivore   Diurnal   16  217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                 Africa Invertivore   Diurnal   76  498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                 Africa Invertivore Nocturnal   55  430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                 Africa    Omnivore   Diurnal    2   87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                 Africa   Piscivore   Diurnal  673  989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                 Africa   Piscivore Nocturnal  221  525</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  Central/South America Detritivore   Diurnal   68 1589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  Central/South America Detritivore Nocturnal    9  318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  Central/South America Invertivore   Diurnal  706 7452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Central/South America Invertivore Nocturnal  486 2101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Central/South America    Omnivore   Diurnal  293 6496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Central/South America    Omnivore Nocturnal   82  203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Central/South America   Piscivore   Diurnal 1275 5226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Central/South America   Piscivore Nocturnal  109  824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         North America Detritivore   Diurnal  142 1741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         North America Invertivore   Diurnal  525 3368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         North America Invertivore Nocturnal  231 1539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         North America    Omnivore   Diurnal  210 1843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         North America    Omnivore Nocturnal    7   38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         North America   Piscivore   Diurnal  536 1289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         North America   Piscivore Nocturnal   19  102</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This examine the omnibus analysis, that is, a 3 x 2 x 4 ANOPA:</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="anopa.html">anopa</a></span><span class="op">(</span> <span class="op">{</span><span class="va">s</span>;<span class="va">n</span><span class="op">}</span> <span class="op">~</span> <span class="va">Location</span> <span class="op">*</span> <span class="va">Trophism</span> <span class="op">*</span> <span class="va">Diel</span>, <span class="va">ArringtonEtAl2002</span><span class="op">)</span> </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ANOPA::fyi(1): Combination of cells missing. Adding: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       Location    Trophism      Diel s n</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>         Africa Detritivore Nocturnal 0 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>         Africa    Omnivore Nocturnal 0 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  North America Detritivore Nocturnal 0 0</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ANOPA::warning(1): Some cells have zero over zero data. Imputing...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Once processed into w, we can ask for a standard plot</span></span></span>
<span class="r-in"><span><span class="fu">anopaPlot</span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="anopa_asn_trans1-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># As you may notice, there are points missing because the data have</span></span></span>
<span class="r-in"><span><span class="co"># three missing cells. The litterature is not clear what should be </span></span></span>
<span class="r-in"><span><span class="co"># done with missing cells. In this package, we propose to impute</span></span></span>
<span class="r-in"><span><span class="co"># the missing cells based on the option `getOption("ANOPA.zeros")`.</span></span></span>
<span class="r-in"><span><span class="co"># Consider this option with care.  </span></span></span>
<span class="r-in"><span><span class="fu">anopaPlot</span><span class="op">(</span><span class="va">w</span>, allowImputing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ANOPA::warning(201): Cell Africa Detritivore Nocturnal missing in data. Imputing...</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ANOPA::warning(201): Cell Africa Omnivore Nocturnal missing in data. Imputing...</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ANOPA::warning(201): Cell North America Detritivore Nocturnal missing in data. Imputing...</span>
<span class="r-plt img"><img src="anopa_asn_trans1-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can place the factor `Diel` on the x-axis (first):</span></span></span>
<span class="r-in"><span><span class="fu">anopaPlot</span><span class="op">(</span><span class="va">w</span>, <span class="op">~</span> <span class="va">Diel</span> <span class="op">*</span> <span class="va">Trophism</span> <span class="op">*</span> <span class="va">Location</span> <span class="op">)</span></span></span>
<span class="r-plt img"><img src="anopa_asn_trans1-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change the style for a plot with bars instead of lines</span></span></span>
<span class="r-in"><span><span class="fu">anopaPlot</span><span class="op">(</span><span class="va">w</span>, plotLayout <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="anopa_asn_trans1-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Changing the error bar style</span></span></span>
<span class="r-in"><span><span class="fu">anopaPlot</span><span class="op">(</span><span class="va">w</span>, plotLayout <span class="op">=</span> <span class="st">"bar"</span>, errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> width <span class="op">=</span><span class="fl">0.1</span>, linewidth<span class="op">=</span><span class="fl">0.1</span> <span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-plt img"><img src="anopa_asn_trans1-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Illustrating the main effect of Location (not interacting with other factors)</span></span></span>
<span class="r-in"><span><span class="co"># and the interaction Diel * Trophism separately</span></span></span>
<span class="r-in"><span><span class="fu">anopaPlot</span><span class="op">(</span><span class="va">w</span>, <span class="op">~</span> <span class="va">Location</span> <span class="op">)</span> </span></span>
<span class="r-plt img"><img src="anopa_asn_trans1-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">anopaPlot</span><span class="op">(</span><span class="va">w</span>, <span class="op">~</span> <span class="va">Diel</span> <span class="op">*</span> <span class="va">Trophism</span> <span class="op">)</span> </span></span>
<span class="r-plt img"><img src="anopa_asn_trans1-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># All these plots are ggplot2 so they can be followed with additional directives, e.g.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">anopaPlot</span><span class="op">(</span><span class="va">w</span>, <span class="op">~</span> <span class="va">Location</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">1.0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for <span style="color: #00BB00;">y</span> is already present.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding another scale for <span style="color: #00BB00;">y</span>, which will replace the existing scale.</span>
<span class="r-plt img"><img src="anopa_asn_trans1-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">anopaPlot</span><span class="op">(</span><span class="va">w</span>, <span class="op">~</span> <span class="va">Diel</span> <span class="op">*</span> <span class="va">Trophism</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">1.0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for <span style="color: #00BB00;">y</span> is already present.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding another scale for <span style="color: #00BB00;">y</span>, which will replace the existing scale.</span>
<span class="r-plt img"><img src="anopa_asn_trans1-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># etc. Any ggplot2 directive can be added to customize the plot to your liking.</span></span></span>
<span class="r-in"><span><span class="co"># See the vignette `ArringtonExample`.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Denis Cousineau, Louis Laurencelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

