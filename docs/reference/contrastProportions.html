<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>contrastProportion: analysis of contrasts between proportions using Anscombe transform. — contrastProportions • ANOPA</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="contrastProportion: analysis of contrasts between proportions using Anscombe transform. — contrastProportions"><meta property="og:description" content="The function contrastProportions() performs contrasts analyses
on proportion data after an omnibus analysis has been obtained with anopa()
according to the ANOPA framework. See Laurencelle and Cousineau (2023)
 for more."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANOPA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/A-WhatIsANOPA.html">What is an Analysis of Proportions using the Anscombe Transform?</a>
    </li>
    <li>
      <a href="../articles/B-DataFormatsForProportions.html">Data formats for proportions</a>
    </li>
    <li>
      <a href="../articles/C-ConfidenceIntervals.html">Confidence intervals with proportions</a>
    </li>
    <li>
      <a href="../articles/D-ArringtonExample.html">Analyzing proportions with the Arrington et al. 2002 example</a>
    </li>
    <li>
      <a href="../articles/E-ArcsineIsAsinine.html">Is the ArcSine transformation so asinine in the end?</a>
    </li>
    <li>
      <a href="../articles/F-TestingTypeIError.html">Testing type-I error rates</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dcousin3/ANOPA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>contrastProportion: analysis of contrasts between proportions using Anscombe transform.</h1>
    <small class="dont-index">Source: <a href="https://github.com/dcousin3/ANOPA/blob/HEAD/R/ANOPA-contrastProportions.R" class="external-link"><code>R/ANOPA-contrastProportions.R</code></a></small>
    <div class="hidden name"><code>contrastProportions.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>contrastProportions()</code> performs contrasts analyses
on proportion data after an omnibus analysis has been obtained with <code><a href="anopa.html">anopa()</a></code>
according to the ANOPA framework. See Laurencelle and Cousineau (2023)
 for more.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">contrastProportions</span><span class="op">(</span>w <span class="op">=</span> <span class="cn">NULL</span>, contrasts <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>w</dt>
<dd><p>An ANOPA object obtained from <code><a href="anopa.html">anopa()</a></code> or <code><a href="emProportions.html">emProportions()</a></code>;</p></dd>


<dt>contrasts</dt>
<dd><p>A list that gives the weights for the contrasts to analyze.
The contrasts within the list can be given names to distinguish them.
The contrast weights must sum to zero and their cross-products must equal 0
as well.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A table of significance of the different contrasts.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>contrastProportions()</code> computes the _F_s for the contrasts,
testing the hypothesis that it equals zero.
The contrasts are each 1 degree of freedom, and the sum of the contrasts'
degrees of freedom totalize the effect-being-decomposed's degree of freedom.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Laurencelle L, Cousineau D (2023).
“Analysis of proportions using arcsine transform with any experimental design.”
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436" class="external-link">doi:10.3389/fpsyg.2022.1045436</a>
.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Basic example using a one between-subject factor design with the data in compiled format. </span></span></span>
<span class="r-in"><span><span class="co"># Ficticious data present success or failure of observation classified according</span></span></span>
<span class="r-in"><span><span class="co"># to the state of residency (three levels); 175 participants have been observed in total.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The cells are unequal:</span></span></span>
<span class="r-in"><span><span class="va">minimalBSExample</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      state  s  n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Florida 31 57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Kentucky 25 73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Montana  9 45</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># First, perform the omnibus analysis :</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="anopa.html">anopa</a></span><span class="op">(</span> <span class="op">{</span><span class="va">s</span>;<span class="va">n</span><span class="op">}</span> <span class="op">~</span> <span class="va">state</span>, <span class="va">minimalBSExample</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             MS  df        F        p correction   Fcorr pvalcorr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> state 0.032384   2 7.335621 0.000652   1.011881 7.24949 0.000711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error 0.004415 Inf                                              </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare the first two states jointly to the third, and</span></span></span>
<span class="r-in"><span><span class="co"># compare the first to the second state:</span></span></span>
<span class="r-in"><span><span class="va">cw</span> <span class="op">&lt;-</span> <span class="fu">contrastProportions</span><span class="op">(</span> <span class="va">w</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>         contrast1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,  <span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>         contrast2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>,  <span class="fl">0</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Not yet programmed...</span>
<span class="r-in"><span><span class="co">#summary(cw)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example using the Arrington et al. (2002) data, a 3 x 4 x 2 design involving </span></span></span>
<span class="r-in"><span><span class="co"># Location (3 levels), Trophism (4 levels) and Diel (2 levels).</span></span></span>
<span class="r-in"><span><span class="va">ArringtonEtAl2002</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Location    Trophism      Diel    s    n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                 Africa Detritivore   Diurnal   16  217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                 Africa Invertivore   Diurnal   76  498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                 Africa Invertivore Nocturnal   55  430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                 Africa    Omnivore   Diurnal    2   87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                 Africa   Piscivore   Diurnal  673  989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                 Africa   Piscivore Nocturnal  221  525</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  Central/South America Detritivore   Diurnal   68 1589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  Central/South America Detritivore Nocturnal    9  318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  Central/South America Invertivore   Diurnal  706 7452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Central/South America Invertivore Nocturnal  486 2101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Central/South America    Omnivore   Diurnal  293 6496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Central/South America    Omnivore Nocturnal   82  203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Central/South America   Piscivore   Diurnal 1275 5226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Central/South America   Piscivore Nocturnal  109  824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         North America Detritivore   Diurnal  142 1741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         North America Invertivore   Diurnal  525 3368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         North America Invertivore Nocturnal  231 1539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         North America    Omnivore   Diurnal  210 1843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         North America    Omnivore Nocturnal    7   38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         North America   Piscivore   Diurnal  536 1289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         North America   Piscivore Nocturnal   19  102</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># performs the omnibus analysis first (mandatory):</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="anopa.html">anopa</a></span><span class="op">(</span> <span class="op">{</span><span class="va">s</span>;<span class="va">n</span><span class="op">}</span> <span class="op">~</span> <span class="va">Location</span> <span class="op">*</span> <span class="va">Trophism</span> <span class="op">*</span> <span class="va">Diel</span>, <span class="va">ArringtonEtAl2002</span><span class="op">)</span> </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ANOPA::fyi(1): Combination of cells missing. Adding: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       Location    Trophism      Diel s n</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>         Africa Detritivore Nocturnal 0 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>         Africa    Omnivore Nocturnal 0 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  North America Detritivore Nocturnal 0 0</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ANOPA::warning(1): Some cells have zero over zero data. Imputing...</span>
<span class="r-in"><span><span class="fu"><a href="corrected.html">corrected</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              MS  df        F correction    Fcorr pvalcorr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location               0.027449   2 0.961802   1.000112 0.961694 0.382245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trophism               0.095656   3 3.351781   1.000115 3.351396 0.018111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Diel                   0.029715   1 1.041227   1.000049 1.041176 0.307548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location:Trophism      0.029485   6 1.033146   1.013842 1.019041 0.410515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location:Diel          0.005277   2 0.184900   1.010164 0.183040 0.832735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trophism:Diel          0.073769   3 2.584868   1.012197 2.553721 0.053559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location:Trophism:Diel 0.011297   6 0.395837   1.055660 0.374967 0.895351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error(between)         0.028539 Inf                                      </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># execute the simple effect of Trophism for every levels of Diel and Location</span></span></span>
<span class="r-in"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="emProportions.html">emProportions</a></span><span class="op">(</span><span class="va">w</span>, <span class="op">~</span> <span class="va">Trophism</span> <span class="op">|</span> <span class="va">Diel</span> <span class="op">*</span> <span class="va">Location</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Not yet programmed...</span>
<span class="r-in"><span><span class="co">#summary(e)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For each of these sub-cells, contrast the four tropisms, first</span></span></span>
<span class="r-in"><span><span class="co"># by comparing the first two levels to the third (contrast1), second</span></span></span>
<span class="r-in"><span><span class="co"># by comparing the first to the second level (contrast2), and finally by</span></span></span>
<span class="r-in"><span><span class="co"># by comparing the first three to the last (contrast3) :</span></span></span>
<span class="r-in"><span><span class="co">#f &lt;- contrastProportions( e, list(</span></span></span>
<span class="r-in"><span><span class="co">#              contrast1 = c(1,  1, -2, 0)/2,</span></span></span>
<span class="r-in"><span><span class="co">#              contrast2 = c(1, -1,  0, 0),</span></span></span>
<span class="r-in"><span><span class="co">#              contrast3 = c(1,  1,  1, -3)/3</span></span></span>
<span class="r-in"><span><span class="co">#           )</span></span></span>
<span class="r-in"><span><span class="co">#      )</span></span></span>
<span class="r-in"><span><span class="co">#summary(f)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Denis Cousineau, Louis Laurencelle.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

