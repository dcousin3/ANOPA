<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing proportions with the Arrington et al. 2002 example • ANOPA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing proportions with the Arrington et al. 2002 example">
<meta property="og:description" content="This vignette describes how a real dataset with 4 factors can be analyzed.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANOPA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A-WhatIsANOPA.html">What is an Analysis of Proportions using the Anscombe Transform?</a>
    </li>
    <li>
      <a href="../articles/BDataFormatsForProportions.html">Data formats for proportions</a>
    </li>
    <li>
      <a href="../articles/CConfidenceIntervals.html">Confidence intervals with proportions</a>
    </li>
    <li>
      <a href="../articles/DArringtonExample.html">Analyzing proportions with the Arrington et al. 2002 example</a>
    </li>
    <li>
      <a href="../articles/EArcsineIsAsinine.html">Is the ArcSine transformation so asinine in the end?</a>
    </li>
    <li>
      <a href="../articles/FTestingTypeIError.html">Testing type-I error rates</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dcousin3/ANOPA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analyzing proportions with the Arrington et
al. 2002 example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dcousin3/ANOPA/blob/HEAD/../vignettes/DArringtonExample.Rmd" class="external-link"><code>../vignettes/DArringtonExample.Rmd</code></a></small>
      <div class="hidden name"><code>DArringtonExample.Rmd</code></div>

    </div>

    
    
<p>Arrington et al. (2002) published a data set available from the web.
It presents species of fish and what proportion of them were empty
stomached when catched. The dataset contained 36000+ catches, which
where identified by their Location (Africa, North America, rest of
America), by their Trophism (their diet, Detritivore, Invertivore,
Omnivore, Piscivore) and by the moment of feeding (Diel: Diurnal or
Nocturnal).</p>
<p>The compiled scores can be consulted with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ArringtonEtAl2002</span></span></code></pre></div>
<pre><code><span><span class="co">##                 Location    Trophism      Diel    s    n</span></span>
<span><span class="co">## 1                 Africa Detritivore   Diurnal   16  217</span></span>
<span><span class="co">## 2                 Africa Invertivore   Diurnal   76  498</span></span>
<span><span class="co">## 3                 Africa Invertivore Nocturnal   55  430</span></span>
<span><span class="co">## 4                 Africa    Omnivore   Diurnal    2   87</span></span>
<span><span class="co">## 5                 Africa   Piscivore   Diurnal  673  989</span></span>
<span><span class="co">## 6                 Africa   Piscivore Nocturnal  221  525</span></span>
<span><span class="co">## 7  Central/South America Detritivore   Diurnal   68 1589</span></span>
<span><span class="co">## 8  Central/South America Detritivore Nocturnal    9  318</span></span>
<span><span class="co">## 9  Central/South America Invertivore   Diurnal  706 7452</span></span>
<span><span class="co">## 10 Central/South America Invertivore Nocturnal  486 2101</span></span>
<span><span class="co">## 11 Central/South America    Omnivore   Diurnal  293 6496</span></span>
<span><span class="co">## 12 Central/South America    Omnivore Nocturnal   82  203</span></span>
<span><span class="co">## 13 Central/South America   Piscivore   Diurnal 1275 5226</span></span>
<span><span class="co">## 14 Central/South America   Piscivore Nocturnal  109  824</span></span>
<span><span class="co">## 15         North America Detritivore   Diurnal  142 1741</span></span>
<span><span class="co">## 16         North America Invertivore   Diurnal  525 3368</span></span>
<span><span class="co">## 17         North America Invertivore Nocturnal  231 1539</span></span>
<span><span class="co">## 18         North America    Omnivore   Diurnal  210 1843</span></span>
<span><span class="co">## 19         North America    Omnivore Nocturnal    7   38</span></span>
<span><span class="co">## 20         North America   Piscivore   Diurnal  536 1289</span></span>
<span><span class="co">## 21         North America   Piscivore Nocturnal   19  102</span></span></code></pre>
<p>One first difficulty with this dataset is that some of the cells are
missing (e.g., African fish that are Detrivore during the night). As is
the case for other sorts of analyses (e.g., ANOVAs), data with missing
cells cannot be analyzed because the error terms cannot be computed.</p>
<p>One solution adopted by was to impute the missing value. We are not
aware if this is an adequate solution, and if so, what imputation would
be acceptable. Consider the following with adequate care.</p>
<p>Warton imputed the missing cells with a very small proportion. In
ANOPA, both the proportions and the group sizes are required. We
implemented a procedure that impute a count of 0.05 (fractional counts
are not possible from observations, but are not forbidden in ANOPA)
obtained from a single observation.</p>
<p>Consult the default option with</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"ANOPA.zeros"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.05 1.00</span></span></code></pre>
<p>The analysis is obtained with</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anopa.html">anopa</a></span><span class="op">(</span> <span class="op">{</span><span class="va">s</span>; <span class="va">n</span><span class="op">}</span> <span class="op">~</span>  <span class="va">Location</span> <span class="op">*</span> <span class="va">Diel</span> <span class="op">*</span> <span class="va">Trophism</span>, <span class="va">ArringtonEtAl2002</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ANOPA::fyi(1): Combination of cells missing. Adding:</span></span></code></pre>
<pre><code><span><span class="co">##       Location      Diel    Trophism s n</span></span>
<span><span class="co">##         Africa Nocturnal Detritivore 0 0</span></span>
<span><span class="co">##         Africa Nocturnal    Omnivore 0 0</span></span>
<span><span class="co">##  North America Nocturnal Detritivore 0 0</span></span></code></pre>
<pre><code><span><span class="co">## Warning in ANOPAwarning("ANOPA::warning(1): Some cells have zero over zero</span></span>
<span><span class="co">## data. Imputing..."): ANOPA::warning(1): Some cells have zero over zero data.</span></span>
<span><span class="co">## Imputing...</span></span></code></pre>
<p>The <code>fyi</code> message lets you know that cells are missing;
the <code>Warning</code> message lets you know that these cells were
imputed.</p>
<p>To see the result,</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                              MS  df        F   pvalue       cf    Fcorr</span></span>
<span><span class="co">## Location               0.027449   2 0.961802 0.382203 1.000112 0.961694</span></span>
<span><span class="co">## Diel                   0.029715   1 1.041227 0.307536 1.000049 1.041176</span></span>
<span><span class="co">## Trophism               0.095656   3 3.351781 0.018102 1.000115 3.351396</span></span>
<span><span class="co">## Location:Diel          0.005277   2 0.184900 0.831187 1.373477 0.134622</span></span>
<span><span class="co">## Location:Trophism      0.029485   6 1.033146 0.401285 1.508640 0.684820</span></span>
<span><span class="co">## Diel:Trophism          0.073769   3 2.584868 0.051365 1.448172 1.784918</span></span>
<span><span class="co">## Location:Diel:Trophism 0.011297   6 0.395837 0.882184 3.045230 0.129986</span></span>
<span><span class="co">## Error(between)         0.028539 Inf                                    </span></span>
<span><span class="co">##                        pvalcorr</span></span>
<span><span class="co">## Location               0.382245</span></span>
<span><span class="co">## Diel                   0.307548</span></span>
<span><span class="co">## Trophism               0.018111</span></span>
<span><span class="co">## Location:Diel          0.874046</span></span>
<span><span class="co">## Location:Trophism      0.661939</span></span>
<span><span class="co">## Diel:Trophism          0.147589</span></span>
<span><span class="co">## Location:Diel:Trophism 0.992601</span></span>
<span><span class="co">## Error(between)</span></span></code></pre>
<p>These suggests an interaction Diel : Trophism close to
significant.</p>
<p>You can easily make a plot with all the factors using</p>
<p><code>{r, message=FALSE, warning=FALSE, fig.width=5, fig.height=3,      fig.cap="**Figure 1**. The proportions in the Arrington et al. 2002 data. Error bars show difference-adjusted 95% confidence intervals."} anopaPlot(w)</code></p>
<p>The missing cells are absent from the plot. To highlight the
interaction, restrict the plot to</p>
<p><code>{r, message=FALSE, warning=FALSE, fig.width=5, fig.height=3,      fig.cap="**Figure 1**. The proportions as a function of class and Difficulty. Error bars show difference-adjusted 95% confidence intervals."} anopaPlot(w, ~ Trophism * Location)</code></p>
<p>which shows clearly massive difference between Trophism, and small
differences between Omnivorous and Piscivorous fishes with regards to
Location.</p>
<p>This can be confirmed by examining simple effects (a.k.a. expected
marginal analyzes):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/emProportions.html">emProportions</a></span><span class="op">(</span> <span class="va">w</span>, <span class="op">~</span> <span class="va">Location</span> <span class="op">*</span> <span class="va">Trophism</span> <span class="op">|</span> <span class="va">Diel</span>  <span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## Not yet programmed...</span></span></code></pre>
<p>(but it will have to wait for the next version of ANOPA ;-)</p>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Denis Cousineau, Louis Laurencelle.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
