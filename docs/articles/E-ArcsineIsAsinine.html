<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Is the ArcSine transformation so asinine in the end? • ANOPA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Is the ArcSine transformation so asinine in the end?">
<meta property="og:description" content="This vignette describes what an analysis of frequency data is.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANOPA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A-WhatIsANOPA.html">What is an Analysis of Proportions using the Anscombe Transform?</a>
    </li>
    <li>
      <a href="../articles/B-DataFormatsForProportions.html">Data formats for proportions</a>
    </li>
    <li>
      <a href="../articles/C-ConfidenceIntervals.html">Confidence intervals with proportions</a>
    </li>
    <li>
      <a href="../articles/D-ArringtonExample.html">Analyzing proportions with the Arrington et al. 2002 example</a>
    </li>
    <li>
      <a href="../articles/E-ArcsineIsAsinine.html">Is the ArcSine transformation so asinine in the end?</a>
    </li>
    <li>
      <a href="../articles/F-TestingTypeIError.html">Testing type-I error rates</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dcousin3/ANOPA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Is the ArcSine transformation so asinine in the
end?</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dcousin3/ANOPA/blob/HEAD/../vignettes/E-ArcsineIsAsinine.Rmd" class="external-link"><code>../vignettes/E-ArcsineIsAsinine.Rmd</code></a></small>
      <div class="hidden name"><code>E-ArcsineIsAsinine.Rmd</code></div>

    </div>

    
    
<p>Some authors documented that analyses of proportions can be performed
with as few as 3 participants per group <span class="citation">(e.g.,
Warton &amp; Hui, 2011)</span>. Some also reported finiding multiple
configurations with significant results using logistic regressions.</p>
<p>We do not think this is sensible.</p>
<p>Let’s generate compiled data with two groups. In the
<code>warton</code> scenario, the first group has only successes and in
the second group, 2 out of 3 participants have failure.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">warton</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  grp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  s   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  n   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>  </span>
<span><span class="op">)</span></span></code></pre></div>
<p>Analyzing this, the ANOPA suggests no difference…</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anopa.html">anopa</a></span><span class="op">(</span> <span class="op">{</span><span class="va">s</span>;<span class="va">n</span><span class="op">}</span><span class="op">~</span><span class="va">grp</span>, <span class="va">warton</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="va">w</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             MS  df        F        p correction    Fcorr pvalcorr</span></span>
<span><span class="co">## grp   0.179169   1 2.508371 0.113243   1.166667 2.150032 0.142567</span></span>
<span><span class="co">## Error 0.071429 Inf</span></span></code></pre>
<p>… something quite evident from the plot:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anopa_asn_trans1.html">anopaPlot</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="E-ArcsineIsAsinine_files/figure-html/unnamed-chunk-4-1.png" alt="**Figure 1**. The proportions for two groups. Error bars show difference-adjusted 95% confidence intervals." width="480"><p class="caption">
<strong>Figure 1</strong>. The proportions for two groups. Error bars
show difference-adjusted 95% confidence intervals.
</p>
</div>
<p>(one tip of the confidence intervals is so off the scale that it is
missing.)</p>
<p>Because the sample is so small, it is actually possible to enumerate
all the possible results (there are 64 of them). If we allow no success
or a single success in one group, and all success in the other group,
there are 14 cases. 14 out of 64 is far from being exceptional, and
thus, there is no significant result here, congruent with the result of
the ANOPA analysis (and contradicting the results from a logistic
regression).</p>
<p>Lets consider a more extreme result: The first group has only
successes and the second, only failures (there is two such cases out of
64):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">laurencelle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  grp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  s   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>  n   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>  </span>
<span><span class="op">)</span></span></code></pre></div>
<p>The analyse using ANOPA says:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anopa.html">anopa</a></span><span class="op">(</span> <span class="op">{</span><span class="va">s</span>;<span class="va">n</span><span class="op">}</span><span class="op">~</span><span class="va">grp</span>, <span class="va">laurencelle</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             MS  df        F        p correction    Fcorr pvalcorr</span></span>
<span><span class="co">## grp   0.429938   1 6.019135 0.014152   1.166667 5.159259 0.023123</span></span>
<span><span class="co">## Error 0.071429 Inf</span></span></code></pre>
<p>that is, a significant result (and note that 2 out of 64 is indeed
rare at the .05 threshold with a p of .031 = 2/64). The plot is
congruent with this result:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anopa_asn_trans1.html">anopaPlot</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="E-ArcsineIsAsinine_files/figure-html/unnamed-chunk-7-1.png" alt="**Figure 2**. The proportions for two extremely different groups. Error bars show difference-adjusted 95% confidence intervals." width="480"><p class="caption">
<strong>Figure 2</strong>. The proportions for two extremely different
groups. Error bars show difference-adjusted 95% confidence intervals.
</p>
</div>
<p>The logistic regression, when applied to proportions, has very
inflated type-I error rates so that this technique should be avoided.
The reason is quite simple: the logit transformation is not
variance-stabilizing. In fact, it exaggerate the variances across levels
of population proportions.</p>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-wh11" class="csl-entry">
Warton, D. I., &amp; Hui, F. K. (2011). The arcsine is asinine: The
analysis of proportions in ecology. <em>Ecology</em>, <em>92</em>, 3–10.
https://doi.org/<a href="https://doi.org/10.1890/10-0340.1%20%20%20" class="external-link">10.1890/10-0340.1 </a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Denis Cousineau, Louis Laurencelle.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
